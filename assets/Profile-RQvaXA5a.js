const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/env-DauFzF5H.js","assets/index-Dtk1fXa2.js","assets/index-C6EMue_y.css"])))=>i.map(i=>d[i]);
import{u as ae,r as m,j as e,c as he,b as ge,y as ve,d as w,e as v,z as be,T as V,L as Ne,A as ye,C as je,B as S,g as K,_ as Y,k as O,m as U,D as Ce,E as we,F as Ae,G as ke}from"./index-Dtk1fXa2.js";import{C as Se,S as Ee,A as Te}from"./ChartSection-DkycSL4D.js";import{g as De}from"./index-BPmxfEGk.js";import{f as Re,u as Me}from"./useQuestionBank-DJH-uY8J.js";import"./env-DauFzF5H.js";const z={children:{name:"ÂÖíÁ´•È°åÂ∫´",icon:"üå±",color:"green",gradeRange:[1,6],description:"ÈÅ©ÂêàÂÖíÁ´•ÁöÑÂü∫Á§éÊâìÂ≠óÁ∑¥Áøí"},bible:{name:"ËÅñÁ∂ìÈ°åÂ∫´",icon:"üìñ",color:"blue",gradeRange:[7,12],description:"ËÅñÁ∂ìÁ∂ìÊñáÊâìÂ≠óÁ∑¥Áøí"}};function ee(t){return z[t]}function Be({selectedBank:t,onBankChange:c,userGrade:f,className:P=""}){const{t:N}=ae(),[_,J]=m.useState(null),[o,b]=m.useState(!0),[L,F]=m.useState(null);m.useEffect(()=>{(async()=>{try{b(!0),F(null);const h=await Re();J(h)}catch(h){console.error("[QuestionBankSelector] Error loading meta:",h),F("ËºâÂÖ•È°åÂ∫´Ë≥áË®äÂ§±Êïó")}finally{b(!1)}})()},[]);const q=()=>f?Object.keys(z).filter(x=>{const h=ee(x);return f>=h.gradeRange[0]&&f<=h.gradeRange[1]}):Object.keys(z),T=x=>_?!!_.questionBanks[x]:!0;if(o)return e.jsx("div",{className:`p-4 ${P}`,children:e.jsx("div",{className:"text-center text-gray-600",children:N("questionBank.loading","ËºâÂÖ•È°åÂ∫´‰∏≠...")})});if(L)return e.jsx("div",{className:`p-4 ${P}`,children:e.jsx("div",{className:"text-center text-red-600",children:L})});const $=q(),I=Object.keys(z).filter(T);return e.jsxs("div",{className:`space-y-4 ${P}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:N("questionBank.title","ÈÅ∏ÊìáÈ°åÂ∫´")}),e.jsx("p",{className:"text-sm text-gray-600",children:N("questionBank.subtitle","ÈÅ∏ÊìáÈÅ©Âêà‰Ω†ÁöÑÁ∑¥ÁøíÈ°åÂ∫´")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:I.map(x=>{const h=ee(x),D=t===x,A=_?.questionBanks[x];return e.jsxs("div",{className:`
                relative p-4 rounded-lg border-2 cursor-pointer transition-all duration-200
                ${D?"border-green-500 bg-green-50 shadow-md":"border-gray-200 hover:border-gray-300 hover:shadow-sm"}
                ${T(x)?"":"opacity-50 cursor-not-allowed"}
              `,onClick:()=>T(x)&&c(x),children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-2xl",children:h.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-1",children:N(`questionBank.${x}.name`,h.name)}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:N(`questionBank.${x}.description`,h.description)}),A&&e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("div",{children:[N("questionBank.gradeRange","Âπ¥Á¥öÁØÑÂúç"),": ",h.gradeRange[0],"-",h.gradeRange[1]]}),e.jsxs("div",{children:[N("questionBank.supportedLanguages","ÊîØÊè¥Ë™ûË®Ä"),": ",A.langs.length]}),e.jsxs("div",{children:[N("questionBank.totalQuestions","Á∏ΩÈ°åÊï∏"),": ",Object.values(A.filesPerLang).reduce((y,j)=>y+j,0)*A.pageSize]})]})]})]}),D&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]},x)})}),f&&$.length===0&&e.jsx("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:N("questionBank.noRecommendation","ÁõÆÂâçÊ≤íÊúâÈÅ©Âêà‰Ω†Âπ¥Á¥öÁöÑÊé®Ëñ¶È°åÂ∫´")})})]})}function Le(){const{t}=ae(),{user:c}=he(),{lang:f}=ge(),P=ve(),{currentBank:N,switchQuestionBank:_,loading:J}=Me(),[o,b]=m.useState({}),[L,F]=m.useState(!1),[q,T]=m.useState({}),[$,I]=m.useState([]),[x,h]=m.useState([]),D=/^(?=.{3,50}$)(?!.*\/).+$/,A=5,[y,j]=m.useState("idle"),[H,W]=m.useState([]),[X,te]=m.useState(!1),[Z,re]=m.useState(!1),C=m.useRef(null);function se(a){if(!a)return 0;const r=String(a).replace(/[^0-9]/g,"");let n=0,d=1;if(/^[0-9]{6,}$/.test(r))n=Number(r.slice(0,4)),d=Number(r.slice(4,6))||1;else{const g=/^([0-9]{4})-([0-9]{2})$/.exec(a);if(!g)return 0;n=Number(g[1]),d=Number(g[2])||1}d=Math.min(12,Math.max(1,d));const s=new Date(n,d-1,1),l=new Date;let i=l.getFullYear()-s.getFullYear();const u=l.getMonth()-s.getMonth();return(u<0||u===0&&l.getDate()<1)&&(i-=1),Math.max(0,i)}const oe=se(o.dobYM),ne=o.role==="teacher"&&oe>=21,le=a=>`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,ie=(()=>{const a=new Date;return a.setFullYear(a.getFullYear()-2),le(a)})(),ce="1900-01",Q=a=>{if(!a)return;const r=document.documentElement;r.setAttribute("lang",a),r.setAttribute("dir",ke(a)?"rtl":"ltr"),r.lang=a,document.body.setAttribute("lang",a);let n=document.querySelector('meta[name="language"]');n||(n=document.createElement("meta"),n.setAttribute("name","language"),document.head.appendChild(n)),n.setAttribute("content",a),document.querySelectorAll('input[type="month"]').forEach(s=>{s.setAttribute("lang",a),s.setAttribute("data-lang",a),s.removeAttribute("lang"),s.setAttribute("lang",a)}),C.current&&(C.current.setAttribute("lang",a),C.current.setAttribute("data-lang",a),C.current.removeAttribute("lang"),C.current.setAttribute("lang",a))};m.useEffect(()=>{f&&Q(f)},[f]),m.useEffect(()=>{C.current&&f&&(C.current.setAttribute("lang",f),C.current.setAttribute("data-lang",f))},[f,o.dobYM]),m.useEffect(()=>{f&&setTimeout(()=>{Q(f)},100)},[]),m.useEffect(()=>{if(!c)return;const a=w(v,"profiles",c.uid),r=be(a,d=>{const s=d.data(),l=Array.isArray(s?.classCodes)?s.classCodes:[],i=String(s?.classCode||"").trim(),u=l.length?l:i?[i]:[];b({displayName:s?.displayName||c.displayName||"",grade:s?.grade,gender:(s?.gender==="N"?"U":s?.gender)||"U",dobYM:s?.dobYM||"",role:s?.role||"student",country:s?.country||void 0,classCode:s?.classCode||"",classCodes:u}),T(g=>({...g,xp:s?.xp||0,points:s?.points||0}))},d=>{console.error("Error listening to profile changes:",d)});return(async()=>{try{const d=w(v,"fruits",c.uid),s=await K(d);T(l=>({...l,fruits:s.exists()?Number(s.data().total||0):0}))}catch(d){console.warn("loadFruits failed",d)}})(),()=>r()},[c]),m.useEffect(()=>{async function a(){if(c)try{console.log("Profile: Getting attempts for user:",c.uid);const r=await De({uid:c.uid,days:30,sampleLimit:50});console.log("Profile: Found",r.length,"attempts");const n=r.slice().reverse(),d=i=>{try{if(!i)return;if(typeof i=="number")return new Date(i);if(i&&typeof i=="object"&&"toDate"in i){const u=i.toDate;return typeof u=="function"?u():void 0}}catch(u){console.warn("toDateSafe failed",u)}},s=n.map((i,u)=>({i:u,adj:Number(i.adjWpm||0),ts:d(i.ts),durationSec:Number(i.durationSec||0),rawChars:Number(i.rawChars||0),accuracy:Math.max(0,Math.min(1,Number(i.accuracy||0))),totalQChars:Array.isArray(i.questions)?i.questions.reduce((g,k)=>g+Number(k.chars||0),0):0})),l=n.map((i,u)=>({i:u,acc:Math.max(0,Math.min(1,Number(i.accuracy||0))),ts:d(i.ts),durationSec:Number(i.durationSec||0),rawChars:Number(i.rawChars||0),adj:Number(i.adjWpm||0),totalQChars:Array.isArray(i.questions)?i.questions.reduce((g,k)=>g+Number(k.chars||0),0):0}));console.log("Profile data arrays:",{adj:s.length,acc:l.length}),I(s),h(l)}catch(r){console.error("Error loading profile data:",r),I([]),h([])}}a()},[c]),m.useEffect(()=>{let a=!0;const n=setTimeout(async()=>{const s=(o.classCode||"").trim().replace(/[Ôºç‚Äî‚Äì]/g,"-");if(!s){a&&j("idle");return}if(!D.test(s)){a&&j("invalid");return}a&&j("checking");try{const{getDoc:l,doc:i}=await Y(async()=>{const{getDoc:R,doc:M}=await import("./env-DauFzF5H.js").then(p=>p.i);return{getDoc:R,doc:M}},__vite__mapDeps([0,1,2])),{db:u}=await Y(async()=>{const{db:R}=await import("./index-Dtk1fXa2.js").then(M=>M.aq);return{db:R}},__vite__mapDeps([1,2])),g=i(u,"classCodes",s),k=await l(g);if(!a)return;if(!k.exists())j("available");else{const R=k.data()?.owner;c&&R===c.uid?j("mine"):j("taken")}}catch{a&&j("error")}},300);return()=>{a=!1,clearTimeout(n)}},[o.classCode,c]);async function de(){if(!c)return;F(!0);const a=w(v,"profiles",c.uid),r=(l,i,u)=>Math.max(i,Math.min(u,l)),n=Number(o.grade??NaN),d={displayName:(o.displayName||"").trim()||void 0,grade:Number.isFinite(n)?r(n,1,6):void 0,gender:o.gender||"U",dobYM:o.dobYM||void 0,role:o.role||"student",country:o.country||void 0,classCodes:Array.isArray(o.classCodes)?o.classCodes.filter(l=>typeof l=="string"&&l.trim().length>0).slice(0,5):void 0,updatedAt:U()},s=Object.fromEntries(Object.entries(d).filter(([,l])=>l!==void 0));await O(a,s,{merge:!0}),F(!1);try{const l=document.createElement("div");l.role="status",l.setAttribute("aria-live","polite"),l.textContent="Loading...",l.style.position="fixed",l.style.right="16px",l.style.bottom="16px",l.style.background="#111827",l.style.color="#fff",l.style.padding="8px 12px",l.style.borderRadius="8px",l.style.boxShadow="0 2px 8px rgba(0,0,0,.2)",document.body.appendChild(l),setTimeout(()=>{try{document.body.removeChild(l)}catch{}},1600)}catch{}}return c?e.jsxs("div",{className:"max-w-[960px] mx-auto px-4",children:[e.jsx("h2",{className:"h2 mb-3",children:t("profile.title")}),e.jsxs("div",{className:"mb-3 body muted",children:[t("profile.googleAccount"),": ",c.email]}),e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs("div",{className:"p-3 border border-[var(--color-border,#e5e7eb)] rounded-[12px]",children:[e.jsxs("div",{className:"text-[12px] text-[var(--color-muted,#6b7280)] flex items-center gap-1",children:[t("profile.points"),e.jsx(V,{label:`${t("profile.pointsTooltip")} ¬∑ ${t("profile.xp")}: ${q.xp??0}`,children:"?"})]}),e.jsx("div",{className:"text-[20px] font-semibold",children:q.points??"‚Äî"})]}),e.jsxs("div",{className:"p-3 border border-[var(--color-border,#e5e7eb)] rounded-[12px]",children:[e.jsxs("div",{className:"text-[12px] text-[var(--color-muted,#6b7280)] flex items-center gap-1",children:[t("profile.fruits"),e.jsx(V,{label:t("profile.fruitsTooltip"),children:"?"})]}),e.jsx("div",{className:"text-[20px] font-semibold",children:q.fruits??0})]})]}),e.jsxs("div",{className:"mb-4 text-[12px] text-[var(--color-muted,#6b7280)]",children:[t("profile.pointsDetail")," ",e.jsx(Ne,{to:`/${f}/garden`,className:"underline",children:t("nav.garden")})," ‚Üí ",t("profile.history")," ",t("profile.view")]}),e.jsxs("div",{className:"grid gap-3 max-w-[560px]",children:[e.jsxs("label",{children:[e.jsx("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:t("profile.nickname")}),e.jsx("input",{"aria-label":"Nickname",value:o.displayName||"",onChange:a=>b({...o,displayName:a.target.value}),className:"w-full h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3"})]}),e.jsxs("label",{children:[e.jsx("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:t("profile.country")}),e.jsxs("select",{"aria-label":"Country",value:o.country||"",onChange:a=>b({...o,country:a.target.value||void 0}),className:"w-full h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3",children:[e.jsx("option",{value:"",children:t("profile.auto")}),(()=>{const a=ye(f),r=je.map(s=>s.code),n=a.filter(s=>r.includes(s.code)),d=a.filter(s=>!r.includes(s.code));return[...n,...d].map(s=>e.jsxs("option",{value:s.code,children:[s.code," ‚Äî ",s.name]},s.code))})()]})]}),e.jsxs("label",{children:[e.jsx("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:t("profile.gender")}),e.jsxs("select",{"aria-label":"Gender",value:o.gender,onChange:a=>b({...o,gender:a.target.value}),className:"w-full h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3",children:[e.jsx("option",{value:"U",children:t("profile.other")}),e.jsx("option",{value:"M",children:t("profile.male")}),e.jsx("option",{value:"F",children:t("profile.female")})]})]}),e.jsxs("label",{children:[e.jsx("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:t("profile.birthday")}),e.jsx("input",{ref:C,"aria-label":"DOB",type:"month",value:(o.dobYM||"").replace(/[^0-9-]/g,""),onChange:a=>b({...o,dobYM:a.target.value}),min:ce,max:ie,className:"w-full h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3",lang:f,"data-lang":f})]}),e.jsxs("label",{children:[e.jsx("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:t("profile.role")}),e.jsxs("select",{"aria-label":"Role",value:o.role,onChange:a=>b({...o,role:a.target.value}),className:"w-full h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3",children:[e.jsx("option",{value:"student",children:t("profile.student")}),e.jsx("option",{value:"teacher",children:t("profile.teacher")}),e.jsx("option",{value:"parent",children:t("profile.parent")}),e.jsx("option",{value:"other",children:t("profile.other")})]})]}),e.jsxs("label",{children:[e.jsxs("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:[t("profile.classCode")," ",e.jsx(V,{label:t("profile.classCodeTooltip"),children:"Ôºü"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("input",{"aria-label":t("profile.classCode"),value:o.classCode||"",onChange:a=>b({...o,classCode:a.target.value}),placeholder:t("profile.classCodePlaceholder"),className:"h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3 w-[220px] sm:w-[260px]"}),e.jsxs("div",{className:"text-xs min-w-[88px] text-center",children:[y==="checking"&&e.jsx("span",{className:"text-[var(--color-muted,#6b7280)]",children:"Checking..."}),y==="invalid"&&e.jsx("span",{className:"text-[var(--color-danger,#ef4444)]",children:"Length must be 3‚Äì50 and cannot contain /"}),y==="error"&&e.jsx("span",{className:"text-[var(--color-danger,#ef4444)]",children:t("profile.error")}),y==="taken"&&e.jsx("span",{className:"text-[var(--color-danger,#ef4444)]",children:t("profile.alreadyTaken")}),y==="mine"&&e.jsx("span",{className:"text-[var(--color-success,#16a34a)]",children:t("profile.youOwnThis")}),y==="available"&&e.jsx("span",{className:"text-[var(--color-success,#16a34a)]",children:t("profile.available")})]}),ne&&e.jsx(S,{variant:"outline",onClick:async()=>{try{if(!c){console.error("[Profile] No user found"),alert(t("profile.noUser"));return}try{if(((await K(w(v,"profiles",c.uid))).data()?.role||"student")!=="teacher"){alert(t("profile.onlyTeacherCanCreate"));return}}catch(p){console.error("[Profile] Error checking user role:",p),alert(t("profile.roleCheckError"));return}const a=(o.classCode||"").trim().replace(/[Ôºç‚Äî‚Äì]/g,"-");if(!D.test(a)){alert(t("profile.invalidCodeFormat"));return}if(y==="taken"){alert(t("profile.codeAlreadyTaken"));return}const{getDocs:r,query:n,where:d,collection:s,limit:l,runTransaction:i,doc:u,serverTimestamp:g}=await Y(async()=>{const{getDocs:p,query:E,where:B,collection:G,limit:ue,runTransaction:me,doc:fe,serverTimestamp:pe}=await import("./env-DauFzF5H.js").then(xe=>xe.i);return{getDocs:p,query:E,where:B,collection:G,limit:ue,runTransaction:me,doc:fe,serverTimestamp:pe}},__vite__mapDeps([0,1,2])),k=n(s(v,"classCodes"),d("owner","==",c.uid),l(A+1));if((await r(k)).size>=A){alert(t("profile.maxClassesReached"));return}const M=u(v,"classCodes",a);await i(v,async p=>{if((await p.get(M)).exists())throw new Error("taken");p.set(M,{owner:c.uid,createdAt:g()})}),console.log("[Profile] Class code created successfully:",a);try{const p=Array.isArray(o.classCodes)?o.classCodes.slice():[];if(p.includes(a))console.log("[Profile] Already in class list");else if(p.length>=5)alert(t("profile.maxJoinedClasses"));else{const E=u(v,"profiles",c.uid),B=Array.from(new Set([...p,a]));await O(E,{classCodes:B,updatedAt:g()},{merge:!0}),b(G=>({...G,classCodes:B})),alert(t("profile.classCreatedAndJoined"))}}catch(p){console.error("[Profile] Error joining created class:",p),alert(t("profile.joinError"))}try{const p=n(s(v,"classCodes"),d("owner","==",c.uid)),E=await r(p);W(E.docs.map(B=>B.id))}catch(p){console.error("[Profile] Error updating class list:",p)}}catch(a){const r=a&&typeof a=="object"&&"message"in a?String(a.message):"";console.error("[Profile] Create class error:",a),alert(r==="taken"?t("profile.codeAlreadyTaken"):t("profile.createError",{error:r}))}},children:t("profile.create")}),e.jsx(S,{onClick:async()=>{try{if(!c){console.error("[Profile] No user found for join"),alert(t("profile.noUser"));return}const r=(o.classCode||"").trim().replace(/[Ôºç‚Äî‚Äì]/g,"-");if(!D.test(r)){alert(t("profile.invalidCodeFormat"));return}if(!(await K(w(v,"classCodes",r))).exists()){alert(t("profile.classNotFound"));return}const d=Array.isArray(o.classCodes)?o.classCodes.slice(0):[];if(d.includes(r)){alert(t("profile.alreadyJoined"));return}if(d.length>=5){alert(t("profile.maxJoinedClasses"));return}const s=w(v,"profiles",c.uid),l=Array.from(new Set([...d,r]));await O(s,{classCodes:l,updatedAt:U()},{merge:!0}),b(i=>({...i,classCodes:l})),console.log("[Profile] Successfully joined class:",r),alert(t("profile.joinSuccess"))}catch(a){console.error("[Profile] Join class error:",a),alert(t("profile.joinError"))}},children:t("profile.join")})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{type:"button",className:"text-[14px] underline text-[var(--color-muted,#6b7280)]",onClick:()=>te(a=>!a),"aria-expanded":X,children:[t("profile.myClasses")," (",H.length,"/",A,")"]}),X&&e.jsxs("div",{className:"mt-2 border border-[var(--color-border,#e5e7eb)] rounded-[12px] p-2",children:[H.length===0&&e.jsx("div",{className:"text-[12px] text-[var(--color-muted,#6b7280)]",children:t("profile.noClasses")}),e.jsx("div",{className:"flex flex-col gap-2",children:H.map(a=>e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"font-mono text-[14px] break-all",children:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(a),alert(t("profile.copySuccess"))}catch{alert(t("profile.copyFailed"))}},children:t("profile.copy")}),e.jsx(S,{variant:"outline",size:"sm",onClick:async()=>{try{if(!c||!confirm(t("profile.confirmDelete")))return;await Ce(w(v,"classCodes",a)),W(r=>r.filter(n=>n!==a))}catch{alert("Error occurred")}},children:t("profile.delete")})]})]},a))})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{type:"button",className:"text-[14px] underline text-[var(--color-muted,#6b7280)]",onClick:()=>re(a=>!a),"aria-expanded":Z,children:[t("profile.joinedClasses")," (",Array.isArray(o.classCodes)?o.classCodes.length:0,"/5)"]}),Z&&e.jsxs("div",{className:"mt-2 border border-[var(--color-border,#e5e7eb)] rounded-[12px] p-2",children:[(!Array.isArray(o.classCodes)||o.classCodes.length===0)&&e.jsx("div",{className:"text-[12px] text-[var(--color-muted,#6b7280)]",children:t("profile.noClasses")}),e.jsx("div",{className:"flex flex-col gap-2",children:(Array.isArray(o.classCodes)?o.classCodes:[]).map(a=>e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"font-mono text-[14px] break-all",children:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:async()=>{try{await navigator.clipboard.writeText(a),alert(t("profile.copySuccess"))}catch{alert(t("profile.copyFailed"))}},children:t("profile.copy")}),e.jsx(S,{variant:"outline",size:"sm",onClick:async()=>{try{if(!c)return;const r=(Array.isArray(o.classCodes)?o.classCodes:[]).filter(n=>n!==a);await O(w(v,"profiles",c.uid),{classCodes:r,updatedAt:U()},{merge:!0}),b(n=>({...n,classCodes:r}))}catch{alert("Error occurred")}},children:t("profile.remove")})]})]},a))})]})]})]}),e.jsxs("label",{children:[e.jsx("div",{className:"mb-1 text-[14px] text-[var(--color-muted,#6b7280)]",children:t("profile.language")}),e.jsx("select",{"aria-label":"Language",value:f,onChange:async a=>{const r=a.target.value;try{if(Q(r),localStorage.setItem("typesprout_lang",r),c)try{const n=w(v,"profiles",c.uid);await O(n,{lang:r,updatedAt:U()},{merge:!0}),console.log("Language saved to Firebase:",r)}catch(n){console.error("Failed to save language to Firebase:",n)}try{const{reloadTranslations:n}=await Y(async()=>{const{reloadTranslations:d}=await import("./index-Dtk1fXa2.js").then(s=>s.as);return{reloadTranslations:d}},__vite__mapDeps([1,2]));await n(r)}catch(n){console.warn("Reload translations failed, continue navigation",n)}P(`/${r}/profile`,{replace:!0})}catch(n){console.error("Language change failed:",n)}},className:"w-full h-11 rounded-[12px] border border-[var(--color-border,#e5e7eb)] px-3",children:we.map(a=>{const r=[{code:"en-US",name:"English",nativeName:"English",flag:"üá∫üá∏"},{code:"zh-TW",name:"Chinese (Traditional)",nativeName:"ÁπÅÈ´î‰∏≠Êñá",flag:"üáπüáº"},{code:"zh-CN",name:"Chinese (Simplified)",nativeName:"ÁÆÄ‰Ωì‰∏≠Êñá",flag:"üá®üá≥"},{code:"es-MX",name:"Spanish",nativeName:"Espa√±ol",flag:"üá≤üáΩ"},{code:"pt-BR",name:"Portuguese",nativeName:"Portugu√™s",flag:"üáßüá∑"},{code:"ja-JP",name:"Japanese",nativeName:"Êó•Êú¨Ë™û",flag:"üáØüáµ"},{code:"ko-KR",name:"Korean",nativeName:"ÌïúÍµ≠Ïñ¥",flag:"üá∞üá∑"},{code:"fr-FR",name:"French",nativeName:"Fran√ßais",flag:"üá´üá∑"},{code:"de-DE",name:"German",nativeName:"Deutsch",flag:"üá©üá™"},{code:"it-IT",name:"Italian",nativeName:"Italiano",flag:"üáÆüáπ"},{code:"id-ID",name:"Indonesian",nativeName:"Bahasa Indonesia",flag:"üáÆüá©"},{code:"vi-VN",name:"Vietnamese",nativeName:"Ti·∫øng Vi·ªát",flag:"üáªüá≥"},{code:"th-TH",name:"Thai",nativeName:"‡πÑ‡∏ó‡∏¢",flag:"üáπüá≠"},{code:"ru-RU",name:"Russian",nativeName:"–†—É—Å—Å–∫–∏–π",flag:"üá∑üá∫"},{code:"ar-SA",name:"Arabic",nativeName:"ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",flag:"üá∏üá¶"},{code:"fil-PH",name:"Filipino",nativeName:"Filipino",flag:"üáµüá≠"},{code:"nl-NL",name:"Dutch",nativeName:"Nederlands",flag:"üá≥üá±"},{code:"pl-PL",name:"Polish",nativeName:"Polski",flag:"üáµüá±"},{code:"sv-SE",name:"Swedish",nativeName:"Svenska",flag:"üá∏üá™"},{code:"nb-NO",name:"Norwegian",nativeName:"Norsk",flag:"üá≥üá¥"},{code:"da-DK",name:"Danish",nativeName:"Dansk",flag:"üá©üá∞"},{code:"fi-FI",name:"Finnish",nativeName:"Suomi",flag:"üá´üáÆ"},{code:"ro-RO",name:"Romanian",nativeName:"Rom√¢nƒÉ",flag:"üá∑üá¥"},{code:"el-GR",name:"Greek",nativeName:"ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨",flag:"üá¨üá∑"},{code:"cs-CZ",name:"Czech",nativeName:"ƒåe≈°tina",flag:"üá®üáø"},{code:"hu-HU",name:"Hungarian",nativeName:"Magyar",flag:"üá≠üá∫"},{code:"uk-UA",name:"Ukrainian",nativeName:"–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞",flag:"üá∫üá¶"},{code:"ms-MY",name:"Malay",nativeName:"Bahasa Melayu",flag:"üá≤üáæ"},{code:"hi-IN",name:"Hindi",nativeName:"‡§π‡§ø‡§®‡•ç‡§¶‡•Ä",flag:"üáÆüá≥"},{code:"bn-BD",name:"Bengali",nativeName:"‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ",flag:"üáßüá©"},{code:"he-IL",name:"Hebrew",nativeName:"◊¢◊ë◊®◊ô◊™",flag:"üáÆüá±"},{code:"fa-IR",name:"Persian",nativeName:"ŸÅÿßÿ±ÿ≥€å",flag:"üáÆüá∑"},{code:"ur-PK",name:"Urdu",nativeName:"ÿßÿ±ÿØŸà",flag:"üáµüá∞"},{code:"tr-TR",name:"Turkish",nativeName:"T√ºrk√ße",flag:"üáπüá∑"}].find(n=>n.code===a);return r?e.jsxs("option",{value:a,children:[r.flag," ",r.nativeName," (",r.name,")"]},a):e.jsx("option",{value:a,children:a},a)})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Be,{selectedBank:N,onBankChange:_,userGrade:o.grade,className:"border border-[var(--color-border,#e5e7eb)] rounded-[12px] p-4"})}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(S,{onClick:()=>void de(),disabled:L||J,children:t("profile.save")}),e.jsx(S,{variant:"outline",onClick:()=>void Ae(),children:t("profile.logout")})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"mb-2 text-[var(--color-muted,#6b7280)]",children:t("profile.analysis")}),e.jsx("div",{className:"flex flex-wrap gap-6 items-start",children:e.jsxs(Se,{topText:t("profile.chartDescription"),children:[e.jsx(Ee,{data:$.length?$:Array.from({length:20},(a,r)=>({i:r,adj:0}))}),e.jsx("div",{className:"h-3"}),e.jsx(Te,{data:x.length?x:Array.from({length:20},(a,r)=>({i:r,acc:0}))})]})})]})]}):e.jsx("div",{className:"max-w-[960px] mx-auto px-4",children:t("ui.loading")})}export{Le as default};
